<script>
  $(document).ready(function () {

    $("#collapse-all").on("click", function () {
      $("#soundboard-filterable div").removeClass("show")
    });
    $("#expand-all").on("click", function () {
      $("#soundboard-filterable div").addClass("show")
    });

    var filterTimeout;
    $("#sound-search").on("keyup", function () {
      // Start/restart timer
      clearTimeout(filterTimeout);
      filterTimeout = setTimeout(() => {
        var value = $(this).val().toLowerCase();
        $("#soundboard-filterable div").addClass("show")
        $("#soundboard-filterable button").filter(function () {
          let searchArray = value.split(' ');
          let buttonText = $(this).text().toLowerCase();
          $(this).toggle(searchArray.every(v => buttonText.indexOf(v) > -1))
        });
        $("#soundboard-filterable h2").filter(function () {
          $(this).toggle($(this).next().find(":visible").length > 0)
        });
      }, 500);

    });
  });
</script>
<div class="soundboard-container">
  <div id="volume-container" class="row no-gutters">
    <p id="volume-text" class="col text-right">{{localize 'SOUNDBOARD.app.volume'}}</p>
    <input type="range" min="1" max="100" value="{{volume}}" class="slider col" id="volumeRange"
      onchange="SoundBoard.updateVolume(this.value)">
  </div>
  <p class="text-muted notes">{{localize 'SOUNDBOARD.app.instructions'}}</p>
  <h3><small class="text-muted">Sounds: {{totalCount}}</small></h3>
  <input id="sound-search" type="text" placeholder="{{localize 'SOUNDBOARD.app.filterText'}}">
  <div id="expand-collapse-container" class="row">
    <button id="collapse-all" class="btn btn-outline-secondary col short text-truncate">{{localize 'SOUNDBOARD.app.collapseall'}}</button>
    <button id="expand-all" class="btn btn-outline-secondary col short text-truncate">{{localize 'SOUNDBOARD.app.expandall'}}</button>
  </div>
  <!-- <button onclick="SoundBoard.stopAllSounds()">{{localize 'SOUNDBOARD.button.stopAll'}}</button>
    <hr/> -->
  <div id="soundboard-filterable" class="soundboard-sounds">
    {{#each sounds}}
    <h2 data-toggle="collapse" data-target="#{{soundboard-safeid categoryName}}" aria-expanded="true"
      aria-controls="{{soundboard-safeid categoryName}}">{{categoryName}} <small class="text-muted">({{length}})</small>
    </h2>
    <div class="collapse show row" id="{{soundboard-safeid categoryName}}">
      {{#each files}}
      {{#if isWild}}
      <button class="btn btn-outline-info col" onclick="SoundBoard.playSound({{id}})"
        oncontextmenu="SoundBoard.previewSound({{id}})">{{name}} <span
          class="badge badge-light">{{soundboard-getarraycount src}}</span></button>
      {{else}}
      <button class="btn btn-outline-dark col" onclick="SoundBoard.playSound({{id}})"
        oncontextmenu="SoundBoard.previewSound({{id}})">{{name}}</button>
      {{/if}}
      {{/each}}

    </div>
    {{/each}}
  </div>
</div>